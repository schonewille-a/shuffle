<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: video.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: video.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import React, { Component } from "react";
import YouTube from "react-youtube";
import shuffle from "shuffle-list";
import searchVideo from "./search.js";
import "../css/video.css";

/** @module Video */
/** The class containing the video component.  This component contians the video player where the music videos will be played.
@name Video */

export default class Video extends Component {
  constructor() {
    super();
    this.state = {
      videoQueue: [],
      videoTitles: [],
      song: 0
    };
  }

  componentWillReceiveProps(nextProps) {
    if(nextProps.song !== this.props.song) {
      this.setState({song: nextProps.song});
    }
    if (nextProps.query !== this.props.query) {
      this.updatePlaylist(nextProps.query);
    }
  }

  // never update state in here, it will cause an infinite loop
  componentWillUpdate(nextProps, nextState) {
    if (
      this.state.song !== nextState.song ||
      this.state.videoQueue !== nextState.videoQueue
    ) {
  		this.state.player.loadVideoById(nextState.videoQueue[nextState.song]);
      this.props.titleCallback(nextState.videoTitles[nextState.song]);
      document.title = nextState.videoTitles[nextState.song];
      this.props.playerCallback(this.state.player);
    }
  }

  /** Updates the playlist of music videos.  This function uses the calls the searchVideo function and then udates serveral arrays containing videoIDs and song titles.
  @param {string} query The query that was used that make the search
  */
  updatePlaylist(query) {
    searchVideo(query).then(vids => {
      var shuffledVids = shuffle(vids);
      var videoIDs = [];
      var titles = [];

      //Removes "(" and "[" from video title and separates 2d array into two 1d arrays
      for(var i = 0; i &lt; vids.length; i++){
        videoIDs[i] = shuffledVids[i][0];
        if(shuffledVids[i][1].indexOf("(") !== -1){
          titles[i] = shuffledVids[i][1].replace(shuffledVids[i][1].substring(shuffledVids[i][1].indexOf("("), shuffledVids[i][1].indexOf(")") + 1), "");
        } else if(shuffledVids[i][1].indexOf("[") !== -1){
          titles[i] = shuffledVids[i][1].replace(shuffledVids[i][1].substring(shuffledVids[i][1].indexOf("["), shuffledVids[i][1].indexOf("]") + 1), "");
        } else {
         titles[i] = shuffledVids[i][1];
        }
      }

      this.setState({
        videoQueue: videoIDs,
        videoTitles: titles,
        song: 0
      });
    });
  }
  /** The event that occurs when the YouTube API has finished loading. When this event occurs, the first video in the playlist begins to play.
  */
  onPlayerReady(event) {
    this.setState(
      {
        player: event.target
      },
      () => {
        this.updatePlaylist(this.props.query);
      }
    );
  }

  /** The event that is called when the next song needs to be played.  Sets the video player to play the next song in the playlist.

  */
  goToNextSong(event) {
    this.setState({
      song: this.state.song + 1
    });
  }

  render() {
    return (
      &lt;div className="wrapperYoutube">
          &lt;YouTube className="vid"
            onReady={this.onPlayerReady.bind(this)}
            onEnd={this.goToNextSong.bind(this)}
            onError={this.goToNextSong.bind(this)}
          />
      &lt;/div>
    );
  }
}</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-App.html">App</a></li><li><a href="module-controls.html">controls</a></li><li><a href="module-Search.html">Search</a></li><li><a href="module-searchBar.html">searchBar</a></li><li><a href="module-TopBar.html">TopBar</a></li><li><a href="module-Video.html">Video</a></li></ul><h3>Classes</h3><ul><li><a href="module-App.html">App</a></li><li><a href="module-controls.html">controls</a></li><li><a href="module-searchBar.html">searchBar</a></li><li><a href="module-TopBar.html">TopBar</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Thu Nov 09 2017 23:34:23 GMT-0500 (Eastern Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
